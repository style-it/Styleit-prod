/*! For license information please see styleit-api.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("styleit",[],t):"object"==typeof exports?exports.styleit=t():e.styleit=t()}("undefined"!=typeof self?self:this,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e){e.exports=JSON.parse('{"Toggle":"toggle","Extend":"extend"}')},function(e,t,n){e.exports=n(4).default},function(e){e.exports=JSON.parse("{}")},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){var t="function"==typeof Map?new Map:void 0;return(a=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return l(e,arguments,s(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),c(r,e)})(e)}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function l(){return(l=i()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&c(o,n.prototype),o}).apply(null,arguments)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o(this,s(t).call(this))}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,e),n=t,(a=[{key:"connectedCallback",value:function(){"true"===this.getAttribute("zero-space")&&(this.innerHTML="&#8203;")}}])&&r(n.prototype,a),i&&r(n,i),t}(a(HTMLElement));customElements.get("text-selection")||customElements.define("text-selection",u)},function(e,t,n){"use strict";n.r(t);var r={H1:"H1",H2:"H2",H3:"H3",H4:"H4",H5:"H5",H6:"H6",P:"P",LI:"LI",OL:"OL",ADDRESS:"ADDRESS",PRE:"PRE"},o="h1,h2,h3,h4,h5,h6,p,pre,address";function a(e,t){for(var n=[],r=e;r&&r.ischildOf(t.parentElement);){var o=r.classList;Array.from(o).forEach((function(e){n.findIndex((function(t){return t===e}))<0&&n.push(e)})),r=r.parentElement}return n}function i(e){return Array.from(e.classList)}function l(e){function t(e){e.className||e.removeAttribute("class")}Array.from(e.querySelectorAll("span[class]")).concat(e).forEach((function(e){return function(e){t(e),Array.from(e.classList).forEach((function(n){Array.from(e.querySelectorAll("[class='".concat(n,"']"))).forEach((function(e){e.classList.remove(n),t(e)}))}))}(e)}))}Element.prototype.removeClassName=function(e){Array.from(this.querySelectorAll("[class='".concat(e,"']"))).concat(this).forEach((function(t){return t.classList.remove(e)}))};var c=void 0;function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var f=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"isElement",value:function(e){try{return e instanceof HTMLElement}catch(t){return"object"===s(e)&&1===e.nodeType&&"object"===s(e.style)&&"object"===s(e.ownerDocument)}}},{key:"wrap",value:function(e,t){var n=[],r=(n=Array.isArray(e)?e:[e]).map((function(e){return e.parentNode}));if(0===r.filter((function(e,t,n){return n[0]!==e})).length)return r[0].insertBefore(t,n[0]),n.forEach((function(e){return t.appendChild(e)})),!0}}])&&u(t.prototype,n),r&&u(t,r),e}());Document.prototype.getSelectedElement=function(){var e=document.getSelection();if(null!==e){var t=e.anchorNode;if(null!==t){for(;3===t.nodeType;)t=t.parentNode;return t}return null}},Element.prototype.wrap=function(e){return"string"==typeof e&&(e=document.createElement(e)),c.parentNode.insertBefore(e,c),e.appendChild(c),e},Element.prototype.createSelection=function(){if(document.body.createTextRange){var e=document.body.createTextRange();e.moveToElementText(this),e.select()}else if(window.getSelection){var t=window.getSelection(),n=document.createRange();n.selectNodeContents(this),t.removeAllRanges(),t.addRange(n)}},Element.prototype.ischildOf=function(e){if(!e)return!1;for(var t=this.parentNode;null!=t;){if(t===e)return!0;t=t.parentNode}return!1};var d=function(e){return!!this.parentNode&&(this.parentNode.insertBefore(e,this),e.appendChild(this),e)};function p(e,t){for(var n={},r=e;r&&r.ischildOf(t.parentElement);){for(var o=r.attributes,a=o.length-1;a>=0;a--)"class"!==o[a].name&&"style"!==o[a].name&&(n[o[a].name]||(n[o[a].name]=o[a].value));r=r.parentElement}return n}function h(e,t){for(var n={},r=e.attributes,o=r.length-1;o>=0;o--)(t||!t&&"class"!==r[o].name&&"style"!==r[o].name)&&(n[r[o].name]||(n[r[o].name]=r[o].value));return n}function y(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.tag,o=void 0===r?"span":r;if(!e.ischildOf(t))return null;if(!f.isElement(e)||!f.isElement(t))return null;var i=function(e,t){var n=w(e,t),r=p(e,t),i=a(e,t),l=document.createElement(o);for(var c in l.className=i.join(" "),n){var s=n[c];l.style[c]=s}for(var u in r){var f=r[u];l.setAttribute(u,f)}return l};e.createSelection();var l=document.getSelectedElement(),c=i(l,t);c.appendChild(e);var s=window.getSelection(),u=s.getRangeAt(0);u.setStart(t,0);var d=document.getSelectedElement(),h=i(d,t),y=u.extractContents();h.appendChild(y),u.setEnd(t,t.childNodes.length);var m=document.getSelectedElement(),v=i(m,t),g=u.extractContents();v.appendChild(g);var E={left:h,center:c,right:v};for(var b in t.innerHTML="",E){var S=E[b];t.appendChild(S)}return t.unwrap(),E}Text.prototype.wrap=d,Element.prototype.wrap=d,Element.prototype.insertAfter=function(e){this.parentNode.insertBefore(e,this.nextSibling)},Element.prototype.replaceNode=function(e){if(this.parentNode)return this.parentNode.insertBefore(e,this),this.remove(),e},Element.prototype.unwrap=function(){var e=document.createRange();e.selectNodeContents(this);var t=e.extractContents();return this.replaceNode(t),t};n(2);function m(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var v=function(e){var t;if(!f.isElement(e))return null;if("SPAN"!==e.nodeName||e.nodeType!==Node.ELEMENT_NODE)return null;var n=e.firstElementChild;if(!n)return null;if("SPAN"!==n.nodeName||n.nodeType!==Node.ELEMENT_NODE)return null;if(e.textContent!==n.textContent)return null;var r={style:T(e),classes:i(e),attrs:h(e)};for(var o in r.style){var a=r.style[o];n.style[o]=(n.style[o]+" "+a).trim()}for(var c in N(n),r.attrs){var s=r.attrs[c];n.setAttribute(c,s)}return(t=n.classList).add.apply(t,m(r.classes)),l(n),E(n),n.parentElement&&n.parentElement.unwrap(),n};function g(e,t){if(!f.isElement(e)||!f.isElement(t))return null;if("SPAN"!==e.nodeName||"SPAN"!==t.nodeName)return null;var n=[{style:T(e),classes:i(e),attrs:h(e)},{style:T(t),classes:i(t),attrs:h(t)}],r=function(e,t){if(!e||!t)return[];var n=m(e),r=m(t);return n.filter((function(e){return r.includes(e)}))}(n[0].classes,n[1].classes),o=function(e,t){var n={};for(var r in e)if(t[r]){var o=e[r],a=t[r];a===o&&(n[r]=a)}return n}(n[0].style,n[1].style),a=function(e,t){var n,r=document.createElement("span");for(var o in e)r.style[o]=e[o];t.length>0&&(n=r.classList).add.apply(n,m(t));return 0===r.attributes.length?(r.unwrap(),null):r}(o,r);if(!a)return null;var c=[e,t];return c.forEach((function(e){!function(e,t){var n;(n=e.classList).remove.apply(n,m(t)),l(e)}(e,r),function(e,t){for(var n in t)e.style[n]=null}(e,o)})),f.wrap(c,a),m(a.children).forEach((function(e){E(e)})),a}function E(e){var t=function(e){Array.from(e.children).forEach((function(e){t(e),n(e)}));var r=function(e){var t=!1;return Array.from(e.children).forEach((function(e){for(var n=e;null!==n;){var r=n.nextSibling;if(!r)break;n=g(n,r),t=t||null!==n}})),t},o=function(e){var t=!1;return Array.from(e.children).forEach((function(e){for(var n=e;n&&1===n.nodeType;)n=v(n),t=t||null!==n})),t},a=!1;do{(e=n(e))&&(r(e),a=o(e))}while(a&&e)};function n(e){return e.normalize(),l(e),N(e),!e||"SPAN"!==e.nodeName||e.textContent.trim()&&0!==e.attributes.length?e:(e.unwrap(),null)}t(e)}function b(e){return e.replace(/\s/g,"").replace(/[\u200B-\u200D\uFEFF]/g,"")}function w(e,t){for(var n={},r=e;r&&r.ischildOf(t.parentElement);){var o=T(r);for(var a in o)if(o.hasOwnProperty(a)){var i=o[a];n[a]||(n[a]=i)}r=r.parentElement}return n}function S(e,t,n,r){e.style[t]=r?e.style[t]+" "+n:e.style[t].replace(n,""),N(e),l(e),Array.from(e.querySelectorAll("[style*='".concat(n,"']"))).forEach((function(e){e.style[t]=e.style[t].replace(n,""),N(e),l(e)}))}function C(e,t,n){var r;e.style[t]=n,"color"===t&&(r={element:e,key:"color",value:n},[function(e){if("color"===e.key){var t=e.element.closest("[style*='text-decoration']");if(t){var n=y(e.element,t);if(n)for(var r in N(),C(n.center,"text-decoration-color","".concat(e.value)),n)E(n[r]);else C(t,"text-decoration-color","".concat(e.value))}}}].forEach((function(e){return e(r)}))),Array.from(e.querySelectorAll("[style*='".concat(t,"']"))).forEach((function(e){e.style[t]=null,N(e)}))}var A=function(e){return w(R(),e)};function N(e){if(!e)return null;if(e.getAttribute("style")){var t=T(e),n=function(n){t.hasOwnProperty(n)&&Array.from(e.querySelectorAll("[style*='".concat(t[n],"']"))).forEach((function(e){e.style[n]=null,N(e)}))};for(var r in t)n(r)}else e.removeAttribute("style")}function T(e){if(!e||!e.style)return{};var t={},n=e.getAttribute("style");if(n){var r=n.split(";");Array.isArray(r)&&r.forEach((function(e){var n=e.split(":");n[1]&&n[0]&&(t[n[0].trim()]=n[1].trim())}))}return t}var x={BR:"BR",HR:"HR",IMG:"IMG",INPUT:"INPUT",AUDIO:"AUDIO",VIDEO:"VIDEO",PICTURE:"PICTURE"},k={};function O(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function L(e){e.normalize(),Array.from(e.childNodes).forEach((function(t){if(1!==t.nodeType||t.textContent.trim()||0!==t.children.length||x[t.nodeName]){if(t.parentElement===e&&t.textContent.trim()&&(1===t.nodeType&&k[t.nodeName]&&!t.parentElement.closest(o)||3===t.nodeType)){var n=document.createElement("p");for(t.wrap(n);n.nextSibling&&(3===n.nextSibling.nodeType||k[n.nextSibling.nodeName]);)n.appendChild(n.nextSibling);n.normalize()}}else q(t)}))}function R(){var e=document.getSelection();if(e){var t=e.focusNode;if(null!==t){for(;3===t.nodeType;)t=t.parentNode;return t}return null}}function P(e,t){var n=function(e){var t,n,r=e.tag;switch(r){case"#text":t=document.createTextNode(e.textContent);break;case"A":(t=document.createElement(r)).href=e.href,t.target=e.target;break;default:t=document.createElement(r),n=!0}return n&&t&&function(e,t){if(e.classList&&(t.classList=O(e.classList)),e.style){var n=function(e){var t=[];for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];t.push("".concat(n,":").concat(r))}return t.join(";")}(e.style);t.style=n}if(e.attrs)for(var r in e.attrs)if(Object.hasOwnProperty.call(e.attrs,r)){var o=e.attrs[r];t.setAttribute(r,o)}}(e,t),t};return t||(t=n(e)),Array.isArray(e.children)&&e.children.forEach((function(e){var r=n(e);r&&(t.appendChild(r),P(e,r))})),t}function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j(e,t){"object"!==D(t)&&(t={});var n=document.createElement(t.el||"span");return Array.from(e.childNodes).forEach((function(e){return n.appendChild(e)})),e.appendChild(n),n}function _(e){return e?(1!==e.nodeType&&(e=e.parentElement),e?e.closest(o):void 0):null}function H(e){return function(){for(var e=[],t=window.getSelection(),n=0;n<t.rangeCount;n++)e[n]=t.getRangeAt(n);return e}().map((function(t){return function(e,t){var n;void 0===t&&(t=window.getSelection().getRangeAt(0));if(t.isCollapsed)return[];void 0===e&&(e="span");"string"==typeof e&&(e=document.createElement(e));return n=function(e,t){var n=t.startContainer,r=t.endContainer,o=t.startOffset,a=t.endOffset;return function(t){var i=document.createRange(),l=e.cloneNode();return i.selectNodeContents(t),t===n&&3===n.nodeType&&(i.setStart(t,o),n=l,o=0),t===r&&3===r.nodeType&&(i.setEnd(t,a),r=l,a=1),i.surroundContents(l),l}}(e,t),K(t).map(n)}(e,t)})).flat()}function M(e){for(var t=((e=e||document.body).ownerDocument||document).createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1),n=[],r=t.nextNode();r;)n.push(r),r=t.nextNode();return n}function B(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e;n.focus();var r=Array.from(n.childNodes).filter((function(e){return e.nodeType===Node.TEXT_NODE}));if(0===r.length){for(r=e;r&&r.firstChild&&3!==r.nodeType;)r=r.firstChild;r&&(r=[r])}var o=document.createRange();o.setStart(r[0],t),o.setEnd(r[0],t),o.collapse(!0);var a=window.getSelection();a.removeAllRanges(),a.addRange(o)}function I(e){var t,n,r=R().closest("[contenteditable]"),o=!0;if(r&&r.contentEditable||(o=!1),!o)return null;if(window.getSelection&&(t=window.getSelection()).getRangeAt&&t.rangeCount){var a;if((n=t.getRangeAt(0)).deleteContents(),"string"==typeof e){(a=document.createElement("div")).innerHTML=e;for(var i,l,c=document.createDocumentFragment();i=a.firstChild;)l=c.appendChild(i);n.insertNode(c)}else"object"===D(e)&&n.insertNode(e);l&&((n=n.cloneRange()).setStartAfter(l),n.collapse(!0),t.removeAllRanges(),t.addRange(n))}}function F(e,t){return e.intersectsNode?e.intersectsNode(t):(n=e,r=function(e){var t=e.ownerDocument.createRange();try{t.selectNode(e)}catch(n){t.selectNodeContents(e)}return t}(t),-1===n.compareBoundaryPoints(Range.END_TO_START,r)&&1===n.compareBoundaryPoints(Range.START_TO_END,r));var n,r}function K(e){var t=e.commonAncestorContainer;return M(t.parentNode||t).filter((function(t){return F(e,t)&&function(e){return e.textContent.length>0}(t)}))}function q(e){e.parentNode&&e.parentNode.removeChild(e)}function V(e,t){t.parentNode.insertBefore(e,t.nextSibling)}["SPAN","BOLD","STRONG","EM","I","S","MARK","B","SUB","SUP","SMALL","INS"].forEach((function(e){k[e]=e}));function U(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={remove:!0};Object.assign(r,n),document.getSelection().setBaseAndExtent(e,0,t,t.childNodes.length),r.remove&&[e,t].forEach((function(e){return e.unwrap()}))}function z(e,t){window.getSelection();var n=document.createElement("text-selection");n.setAttribute("zero-space",0===e.textContent.length);var r=document.createElement("text-selection");return r.setAttribute("zero-space",0===t.textContent.length),e.prepend(n),t.appendChild(r),{firstFlag:n,lastFlag:r}}var W=n(0);function X(e){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function G(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var J=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.target=t,this.stylesToPaste="object"===X(n.stylesToPaste)?n.stylesToPaste:null,this.paste=this.paste.bind(this),this.copy=this.copy.bind(this),this.start()}var t,n,a;return t=e,(n=[{key:"copy",value:function(e){var t=this,n="";if(X(window.getSelection)){var r=window.getSelection();if(r.rangeCount){for(var o=document.createElement("div"),a=function(){var e=r.getRangeAt(i).cloneContents();o.appendChild(e),Array.from(o.childNodes).forEach((function(n){if(3===n.nodeType){var o=w(r.getRangeAt(i).startContainer.parentNode,t.target),a=document.createElement("span");a.textContent=e.textContent,function(e,t){for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];e.style[n]=r}}(a,o),n.wrap(a)}else x[n.nodeName]&&"BR"!==n.nodeName&&n.parentElement.removeChild(n)}))},i=0,l=r.rangeCount;i<l;++i)a();n=o}}else X(document.selection)&&"Text"===document.selection.type&&(n=document.selection.createRange().htmlText);e.preventDefault(),e.clipboardData.setData("styleit/html",n.innerHTML),e.clipboardData.setData("text/plain",n.textContent)}},{key:"paste",value:function(e){e.shiftKey?this.pastePlainText(e):this.pasteWithStyles(e)}},{key:"pastePlainText",value:function(e){var t=this,n=e.clipboardData||window.clipboardData;e.preventDefault();var r=n.getData("text/plain").trim();if((r=r.replace(/\n/g,"<br/>")).trim()){var o=document.createElement("p");o.innerHTML=r,I(o),B(o),o.parentElement!==this.target&&o.unwrap(),Array.from(this.target.children).forEach((function(e){e.textContent.trim()||t.target.removeChild(e)}))}}},{key:"pasteWithStyles",value:function(e){e.preventDefault();var t=(e.clipboardData||window.clipboardData).getData("styleit/html").trim();if(t){var n=document.createElement("div");n.innerHTML=t,I(n),Array.from(n.children).forEach((function(e){b(e.textContent)||x[e.nodeName]||e.parentElement.removeChild(e)})),Array.from(n.children).forEach((function(e){var t=e.parentElement.closest(o);t&&r[e.nodeName]&&b(t.textContent)===b(n.textContent)?t.parentElement.insertBefore(e,t):1===e.nodeType&&r[e.nodeName]&&t?(n.children.length>1&&e.insertAfter(document.createElement("BR")),e.unwrap()):b(e.textContent)||e.unwrap()}));var a=n.closest(o);if(a){var i=y(n,a,{tag:a.nodeName});i&&(i.left.appendChild(i.center),i.center.appendChild(i.right),i.right.unwrap(),i.center.unwrap())}E(this.target),B(n),n.unwrap()}else this.pastePlainText(e)}},{key:"start",value:function(){this.target.addEventListener("paste",this.paste),this.target.addEventListener("copy",this.copy)}},{key:"destroy",value:function(){this.target.removeEventListener("paste",this.paste),this.target.removeEventListener("copy",this.copy)}}])&&G(t.prototype,n),a&&G(t,a),e}(),Q={},Y={_blank:"_blank",_self:"_self",_parent:"_parent",_top:"_top"},Z=function(e){return e=(e=(e=(e=(e=e.replace(/https:/g,"")).replace(/http:/g,"")).replace(/mailto:/g,"")).replace(/tel:/g,"")).replace(/\//g,"")},$=function(e){var t=document.createElement("a");return t.href=e,t};var ee=function e(t,n){var r=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)return null;this.onInspect=n,this.target=t;var o=function(){var e=A(r.target);"function"==typeof r.onInspect&&r.onInspect(e),"function"==typeof Q.inspect&&Q.inspect(e);var t=R();if(t){var n=t.closest("a");n&&"function"==typeof Q.inspectLink&&Q.inspectLink({protocol:n.protocol,href:Z(n.href),target:n.getAttribute("target")||"",element:n})}};this.onKeyDown=function(e){if(8===e.keyCode&&r.target.children.length<=1&&!r.target.textContent)return e.preventDefault(),!1;o()},this.onClick=function(){o()},this.target.addEventListener("click",this.onClick),this.target.addEventListener("keydown",this.onKeyDown),this.Destroy=function(){r.target.removeEventListener("click",r.onClick),r.target.removeEventListener("keydown",r.onKeyDown),r.target=null}};function te(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var ne=function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(te(this,e),!t)return null;"function"==typeof r.onKeyPress&&(this.onKeyPress=r.onKeyPress),this.target=t,this.keypress=function(e){var t=window.getSelection();if(3===t.focusNode.nodeType&&!t.focusNode.parentElement.closest(o)){var r=document.createElement("P");t.focusNode.wrap(r),B(r,1)}if(8===e.keyCode)""===b(e.target.textContent)&&e.preventDefault();else if(13===e.keyCode){if(e.shiftKey)return I("</br>&#8203;"),void e.preventDefault();var a=document.createRange(),i=window.getSelection(),l=_(i.anchorNode);if(l===n.target||!l)return!1;if(i.getRangeAt(0).extractContents(),a.setStart(i.anchorNode,i.anchorOffset),a.setEnd(l,l.childNodes.length),i.removeAllRanges(),i.addRange(a),i.isCollapsed)return l&&!n.target.textContent.trim()&&l!==n.target&&(Array.from(n.target.children).forEach((function(e){e===l||e.textContent.trim()||e.unwrap()})),l.innerHTML=l.innerHTML+"&#8203;",B(l),e.preventDefault()),!1;e.preventDefault();var c=a.extractContents();Array.from(c.children).forEach((function(e){1!==e.nodeType||e.textContent.trim()||x[e.nodeName]||e.unwrap()}));var s=document.createElement(l.nodeName||"p");s.appendChild(c),s.textContent.trim()||(s.innerHTML="&#8203;"),V(s,l),Array.from(s.previousSibling.attributes).forEach((function(e){s.setAttribute(e.name,e.value)}));var u=document.createElement("br");l.appendChild(u),i.removeAllRanges(),L(n.target),B(s,0)}else"function"==typeof n.onKeyPress&&n.onKeyPress(e)},this.target.addEventListener("keydown",this.keypress),this.Destroy=function(){n.target.removeEventListener("keydown",n.keypress),n.target=null}};function re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var oe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"Connect",value:function(e,t){return("string"!=typeof e||(e=document.getElementById(e)))&&f.isElement(e)?(document.execCommand("defaultParagraphSeparator",!1,"p"),document.execCommand("styleWithCSS",!0,null),Array.from(e.querySelectorAll("[contenteditable]")).forEach((function(e){L(e)})),this.createDefaultStyle(),this.plugins=function(e,t){return{copyPaste:new J(e,t),inspector:new ee(e,t.onInspect),keyPress:new ne(e,t)}}(e,t),e):null}},{key:"createDefaultStyle",value:function(){var e=document.createElement("style");e.innerHTML="\n            [contenteditable]{\n                min-height:10px;\n            }\n            ",document.head.appendChild(e)}},{key:"Destroy",value:function(){for(var e in this.plugins)this.plugins.hasOwnProperty(e)&&this.plugins[e].Destroy()}}])&&re(t.prototype,n),r&&re(t,r),e}();n(3);function ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var le=function(){function e(t,n){var r,o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.__config={onInspect:void 0},this.on=function(e,t){Q[e]=t},this.Connector=new oe,this.modeHandlers=(ae(r={},W.Toggle,(function(e,t,n,r){return o.onToggle(e,t,n,r)})),ae(r,W.Extend,(function(e,t,n,r){return o.onExtend(e,t,n,r)})),r),this.config=n?Object.assign(this.__config,n):this.__config,this.events={styleChanged:this.config.onInspect},this.connectedElement=this.Connector.Connect(t,this.config)}var t,n,a;return t=e,(n=[{key:"save",value:function(e){return function e(t){var n=t.nodeName,r=!0,o={},a=!0;switch(n){case"#text":o.tag=n,o.textContent=t.textContent.replace(/\u200B/g,""),r=!1,o.textContent.trim()||(a=!1);break;case"A":o.tag=n,o.href=t.href,o.target=t.target;break;default:o.tag=n}return a?(r&&(o.attrs={},Array.from(t.attributes).forEach((function(e){switch(e.name){case"style":var n=T(t);Object.keys(n).length>0&&(o.style=n);break;case"class":t.classList&&t.classList.length>0&&(o.classList=O(t.classList));break;default:o.attrs[e.name]=e.value}})),t.childNodes&&t.childNodes.length>0&&(o.children=O(t.childNodes).map((function(t){return e(t)})).filter((function(e){return e})))),o):null}(e||this.connectedElement)}},{key:"load",value:function(e){return P(e,this.connectedElement)}},{key:"destroy",value:function(){for(var e in this.Connector.Destroy(),this)this[e]=null,delete this[e]}},{key:"unLink",value:function(){if(this.isValid()){var e=window.getSelection();if(e&&!e.toString()){var t,n=e.baseNode;return n&&3===n.nodeType&&n.parentElement&&(t=n.parentElement),n&&1===n.nodeType&&(t=t.closest("a")),t&&t.unwrap(),null}var r=H();Array.from(r).forEach((function(e){var t=e.closest("a");if(t){var n=y(e,t,{tag:"a"});n&&n.center.unwrap()}Array.from(e.querySelectorAll("a")).forEach((function(e){e.unwrap()})),e.unwrap()}));var o=z(r[0],r[r.length-1]);U(o.firstFlag,o.lastFlag)}}},{key:"link",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e&&(!e||e.href)&&this.isValid()){if(window.getSelection&&!window.getSelection().toString())return null;var t=function(e,t){return e=(e=e.replace(/:/g,"")).replace(/\/\//g,""),(e+=":").includes("http")&&(e+="//"),t.push(e),e},n=e.href,r=void 0===n?"":n,o=e.protocol,a=void 0===o?"":o,i=e.target,l=void 0===i?"":i,c=H("a"),s=[],u=$(r),f=Z(r.trim()),d=a.trim()||u.protocol,p=null,h=Y[l.trim().toLowerCase()];h&&(p=h),d.trim()&&(d=t(d,s)),f&&s.push(f);var m=s.join("");!function(e){e.forEach((function(e){Array.from(e.querySelectorAll("a")).forEach((function(e){return e.unwrap()}));var t=e.parentElement?e.parentElement.closest("a"):null;if(t){var n=y(e,t,{tag:"a"});n&&n.center.unwrap()}}))}(c),function(e,t,n){e.forEach((function(e){e.href=t,n&&e.setAttribute("target",n)}))}(c,m,p);var v=z(c[0],c[c.length-1]),g=v.firstFlag,b=v.lastFlag;U(g,b),E(this.connectedElement)}}},{key:"formatBlock",value:function(e){if(!r[e.toUpperCase()])throw Error("valid tags: ".concat(o));var t=function(e){var t=window.getSelection(),n=[],r=t.getRangeAt(0).commonAncestorContainer;if(3===r.nodeType&&(r=r.parentElement),!r)return n;for(var o,a=r.querySelectorAll(e),i=0;o=a[i];i++)t.containsNode(o,!0)&&n.push(o);if(0===n.length){var l=R();if(l){var c=l.closest(e);c&&n.push(c)}}return n}(o);if(t.length>0){var n=H(),a=z(n[0],n[n.length-1]),i=a.firstFlag,l=a.lastFlag;t.forEach((function(t){var n=document.createElement(e);Array.from(t.attributes).forEach((function(e){n.setAttribute(e.name,e.value)})),t.wrap(n),t.unwrap()})),Array.from(n).forEach((function(e){return e.unwrap()})),U(i,l)}}},{key:"toggleClass",value:function(e,t){if(this.isValid()){if("string"!=typeof e)return null;var n=H();if(0!==n.length){t||(t={}),("boolean"==typeof t.isON?t.isON:n[0].closest("[class='".concat(e,"']")))?n.forEach((function(t){if(t.parentElement){var n=t.parentElement.closest("[class='".concat(e,"']"));if(n){var r=y(t,n);r&&r.center.removeClassName(e)}}else t.removeClassName(e)})):n.forEach((function(t){return t.classList.add(e)}));var r=z(n[0],n[n.length-1]),o=r.firstFlag,a=r.lastFlag;if(E(this.connectedElement),o&&a)U(o,a);else{var i=window.getSelection();i.removeAllRanges&&i.removeAllRanges()}}}}},{key:"execCmd",value:function(e,t,n,r){var o=this;if(this.isValid()&&this.isVAlidKeyValue(e,t)){this.connectedElement.normalize(),this.ELEMENTS=[],n=n||W.Extend,r||(r={}),this.ELEMENTS=H(),r.unWrap&&Array.isArray(r.unWrap)&&r.unWrap.forEach((function(e){o.ELEMENTS.forEach((function(t){var n=t.closest(e);n&&n.unwrap()}))}));var a,i,l=z(this.ELEMENTS[0],this.ELEMENTS[this.ELEMENTS.length-1]),c=l.firstFlag,s=l.lastFlag;if(a=M(this.connectedElement),Array.isArray(a)||(a=[a]),a.forEach((function(e){e.nodeType===Node.TEXT_NODE&&e.parentElement&&"TEXT-SELECTION"!==e.parentElement.nodeName&&(e.textContent=e.textContent.replace(/\u200B/g,""))})),this.ELEMENTS.forEach((function(a){r.onOff=i;var l=o.modeHandlers[n](a,e,t,r);n===W.Toggle&&void 0===i&&(i=l)})),E(this.connectedElement),c&&s)U(c,s);else{var u=window.getSelection();u.removeAllRanges&&u.removeAllRanges(),this.caretHolder&&(B(this.caretHolder,this.caretHolder.textContent.length),this.caretHolder.unwrap(),this.caretHolder=null)}var f=A(this.connectedElement);"function"==typeof Q.inspect&&Q.inspect(f),this.dispatchEvent("styleChanged",f)}}},{key:"createCaretPlacement",value:function(e){if(!e)return null;var t=document.createElement("text-selection");return t.setAttribute("zero-space","true"),e.appendChild(t),t}},{key:"dispatchEvent",value:function(e,t){this.events[e]&&this.events[e](t)}},{key:"onToggle",value:function(e,t,n,o){if("block"!==o.target){var a=e.closest("[style*='".concat(n,"']"));if(a&&r[a.nodeName]){var i=j(a);return a.style[t]=null,i.style[t]=n,o.onOff=!1,this.onToggle(e,t,n,o)}if(a&&a!==e){void 0===o.onOff&&(o.onOff=!1);var l=y(e,a);l&&S(l.center,t,n,o.onOff)}else void 0===o.onOff&&a?o.onOff=!1:void 0===o.onOff&&(o.onOff=!0),S(e,t,n,o.onOff),E(e);return o.onOff}this.createBlockStyle(o,e,t,n)}},{key:"onExtend",value:function(e,t,n,r){if("block"===r.target)this.createBlockStyle(r,e,t,n);else{var o=e.closest("[style*='".concat(t,"']"));if(o){var a=y(e,o);if(a)C(a.center,t,n);else if("block"===r.target)o.style[t]=n;else{if("block"!==r.target)return C(j(o,{el:"span"}),t,n),o.style[t]=null,this.onExtend(e,t,n);if(o!==e){var i=y(e,o);i&&C(i.center,t,n)}}}else if("block"!==window.getComputedStyle(e).display&&"block"===r.target){var l=_(e);if(l&&l.ischildOf(this.connectedElement))C(parentElement,t,n);else{var c=document.createElement("div");parentElement.wrap(c),C(c,t,n)}}else C(e,t,n)}}},{key:"createBlockStyle",value:function(e,t,n,r){if("inline"===e.as){var o=_(t);if(o){var a=function(e){e.style[n]=null,Array.from(e.childNodes).forEach((function(e){3===e.nodeType?function(e){var t=document.createElement("span");t.style[n]=r,e.wrap(t)}(e):1!==e.nodeType||x[e.nodeName]?e.style[n]=r:a(e)}))};a(o)}}else!function(e,t,n){var r=_(e);r&&(r.style[t]=n,Array.from(r.querySelectorAll("[style*='".concat(t,"']"))).forEach((function(e){return e.style[t]=null})))}(t,n,r)}},{key:"isVAlidKeyValue",value:function(e,t){return!("string"!=typeof e||"string"!=typeof t)}},{key:"isValid",value:function(){if(!this.connectedElement)return!1;var e=R();return!!(e&&e.ischildOf(this.connectedElement)&&e.isContentEditable)||void 0}}])&&ie(t.prototype,n),a&&ie(t,a),e}();n.d(t,"default",(function(){return ce}));var ce=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r=new le(t,n);r&&(this.execCmd=r.execCmd,this.toggleClass=r.toggleClass,this.link=r.link,this.unLink=r.unLink,this.formatBlock=r.formatBlock,this.save=r.save,this.load=r.load,this.destroy=r.destroy,this.on=r.on,this.MODES=W,this.toggleClass=this.toggleClass.bind(r),this.execCmd=this.execCmd.bind(r),this.formatBlock=this.formatBlock.bind(r),this.on=this.on.bind(r),this.link=this.link.bind(r),this.unLink=this.unLink.bind(r),this.save=this.save.bind(r),this.load=this.load.bind(r),this.destroy=this.destroy.bind(r))}}])}));
//# sourceMappingURL=main.js.map
//# sourceMappingURL=styleit-api.js.map